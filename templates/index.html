<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lọc và Thay Thế Liên Kết</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .section {
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
        }
        .section-header {
            margin-bottom: 15px;
        }
        textarea {
            width: 100%;
            margin-bottom: 10px;
        }
        button {
            margin-top: 10px;
        }
        .group-section {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            background-color: #f0f8ff;
        }
        .button-container {
            display: flex;
            gap: 10px;
        }
    </style>
</head>
<body>
    <h1>Lọc và Thay Thế Liên Kết</h1>

    <div class="section link-section">
        <h2 class="section-header">Lọc và Thay Thế Liên Kết</h2>
        <textarea id="inputText" rows="6" placeholder="Nhập văn bản ở đây để lọc liên kết..."></textarea>
        <div class="button-container">
            <button onclick="extractLinks()">Lọc Liên Kết</button>
            <button onclick="clearInput('inputText')">Xóa Văn Bản</button>
        </div>

        <h3>Các Liên Kết Đã Tìm Thấy:</h3>
        <div id="linkSections"></div>

        <h3>Văn Bản Đã Thay Đổi:</h3>
        <textarea id="outputText" rows="6" readonly></textarea>
        <div class="button-container">
            <button id="copyResultButton" onclick="copyResult()" style="display: none;">Sao Chép Kết Quả</button>
            <button onclick="clearInput('outputText')">Xóa Văn Bản</button>
        </div>
    </div>

    <script>
        let links = [];

        function clearInput(textareaId) {
            document.getElementById(textareaId).value = '';
        }

        function extractLinks() {
            const text = document.getElementById('inputText').value;
            const linkPattern = /https?:\/\/[^\s]+/g;
            links = text.match(linkPattern) || [];

            displayLinks(links);
        }

        function displayLinks(links) {
            const linkSections = document.getElementById('linkSections');
            linkSections.innerHTML = '';

            if (links.length === 0) {
                linkSections.innerHTML = '<p>Không tìm thấy liên kết nào.</p>';
                return;
            }

            const section = document.createElement('div');
            section.classList.add('group-section');

            const list = document.createElement('ul');
            links.forEach(link => {
                const listItem = document.createElement('li');
                listItem.textContent = link;
                list.appendChild(listItem);
            });
            section.appendChild(list);

            const replacementInput = document.createElement('textarea');
            replacementInput.rows = 3;
            replacementInput.placeholder = `Nhập liên kết thay thế, mỗi liên kết trên một dòng...`;
            section.appendChild(replacementInput);

            const replaceButton = document.createElement('button');
            replaceButton.textContent = 'Thay Thế Liên Kết';
            replaceButton.onclick = () => replaceLinks(links, replacementInput.value.trim());
            section.appendChild(replaceButton);

            linkSections.appendChild(section);
        }

        function replaceLinks(links, replacements) {
            const replacementArray = replacements.split('\n').map(link => link.trim()).filter(link => link);
            if (replacementArray.length !== links.length) {
                alert(`Số lượng liên kết thay thế phải bằng số liên kết hiện tại (${links.length}).`);
                return;
            }

            let text = document.getElementById('inputText').value;

            links.forEach((link, index) => {
                const regex = new RegExp(link.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
                text = text.replace(regex, replacementArray[index]);
            });

            document.getElementById('outputText').value = text;
            document.getElementById('inputText').value = text;
            document.getElementById('copyResultButton').style.display = 'inline';
            alert('Đã thay thế các liên kết.');
        }

        function copyResult() {
            const textArea = document.createElement('textarea');
            textArea.value = document.getElementById('outputText').value;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            alert('Đã sao chép kết quả văn bản!');
        }
    </script>
</body>
</html>
